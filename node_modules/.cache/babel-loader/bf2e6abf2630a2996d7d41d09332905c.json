{"ast":null,"code":"import { PathFactory, defaultHandlers } from 'ldflex';\nimport context from '@solid/context';\nimport PutHandler from './handlers/PutHandler';\nimport SolidDeleteFunctionHandler from './handlers/SolidDeleteFunctionHandler';\nimport FindActivityHandler from './handlers/FindActivityHandler';\nimport CreateActivityHandler from './handlers/CreateActivityHandler';\nimport DeleteActivityHandler from './handlers/DeleteActivityHandler';\nimport SourcePathHandler from './handlers/SourcePathHandler';\nimport UserPathHandler from './handlers/UserPathHandler';\nimport ContextResolver from './resolvers/ContextResolver';\nimport SubjectPathResolver from './resolvers/SubjectPathResolver';\nconst {\n  as\n} = context['@context'];\nconst contextResolver = new ContextResolver(context); // Handlers for subject paths\n\nconst subjectHandlers = { ...defaultHandlers,\n  // HTTP PUT handler\n  put: new PutHandler(),\n  // Custom delete handler to match node-solid-server behavior\n  delete: new SolidDeleteFunctionHandler(),\n  // Find activities\n  findActivity: new FindActivityHandler(),\n  likes: (_, path) => path.findActivity(\"\".concat(as, \"Like\")),\n  dislikes: (_, path) => path.findActivity(\"\".concat(as, \"Dislike\")),\n  follows: (_, path) => path.findActivity(\"\".concat(as, \"Follow\")),\n  // Create activities\n  createActivity: new CreateActivityHandler(),\n  like: (_, path) => () => path.createActivity(\"\".concat(as, \"Like\")),\n  dislike: (_, path) => () => path.createActivity(\"\".concat(as, \"Dislike\")),\n  follow: (_, path) => () => path.createActivity(\"\".concat(as, \"Follow\")),\n  // Delete activities\n  deleteActivity: new DeleteActivityHandler(),\n  unlike: (_, path) => () => path.deleteActivity(\"\".concat(as, \"Like\")),\n  undislike: (_, path) => () => path.deleteActivity(\"\".concat(as, \"Dislike\")),\n  unfollow: (_, path) => () => path.deleteActivity(\"\".concat(as, \"Follow\"))\n}; // Creates an LDflex for Solid root path with the given settings\n\nexport default function createRootPath(defaultSettings) {\n  let rootPath = null; // Factory for data paths that start from a given subject\n\n  const subjectPathFactory = new PathFactory({\n    handlers: { ...subjectHandlers,\n      root: () => rootPath\n    },\n    resolvers: [contextResolver]\n  }); // Root path that resolves the first property access\n\n  rootPath = new PathFactory({\n    // Handlers of specific named properties\n    handlers: { ...defaultHandlers,\n      // The `from` function takes a source as input\n      from: new SourcePathHandler(subjectPathFactory),\n      // The `user` property starts a path with the current user as subject\n      user: new UserPathHandler(subjectPathFactory),\n      // Clears the cache for the given document (or everything, if undefined)\n      clearCache: ({\n        settings\n      }) => doc => settings.createQueryEngine().clearCache(doc),\n      // Expose the JSON-LD context\n      context: contextResolver\n    },\n    // Resolvers for all remaining properties\n    resolvers: [// `data[url]` starts a path with the property as subject\n    new SubjectPathResolver(subjectPathFactory)],\n    ...defaultSettings\n  }).create();\n  return rootPath;\n}","map":{"version":3,"sources":["/Users/mark/localRepos/StarBrightlyShining/node_modules/@solid/query-ldflex/module/RootPath.js"],"names":["PathFactory","defaultHandlers","context","PutHandler","SolidDeleteFunctionHandler","FindActivityHandler","CreateActivityHandler","DeleteActivityHandler","SourcePathHandler","UserPathHandler","ContextResolver","SubjectPathResolver","as","contextResolver","subjectHandlers","put","delete","findActivity","likes","_","path","concat","dislikes","follows","createActivity","like","dislike","follow","deleteActivity","unlike","undislike","unfollow","createRootPath","defaultSettings","rootPath","subjectPathFactory","handlers","root","resolvers","from","user","clearCache","settings","doc","createQueryEngine","create"],"mappings":"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","sourcesContent":["import { PathFactory, defaultHandlers } from 'ldflex';\nimport context from '@solid/context';\nimport PutHandler from './handlers/PutHandler';\nimport SolidDeleteFunctionHandler from './handlers/SolidDeleteFunctionHandler';\nimport FindActivityHandler from './handlers/FindActivityHandler';\nimport CreateActivityHandler from './handlers/CreateActivityHandler';\nimport DeleteActivityHandler from './handlers/DeleteActivityHandler';\nimport SourcePathHandler from './handlers/SourcePathHandler';\nimport UserPathHandler from './handlers/UserPathHandler';\nimport ContextResolver from './resolvers/ContextResolver';\nimport SubjectPathResolver from './resolvers/SubjectPathResolver';\nconst {\n  as\n} = context['@context'];\nconst contextResolver = new ContextResolver(context); // Handlers for subject paths\n\nconst subjectHandlers = { ...defaultHandlers,\n  // HTTP PUT handler\n  put: new PutHandler(),\n  // Custom delete handler to match node-solid-server behavior\n  delete: new SolidDeleteFunctionHandler(),\n  // Find activities\n  findActivity: new FindActivityHandler(),\n  likes: (_, path) => path.findActivity(\"\".concat(as, \"Like\")),\n  dislikes: (_, path) => path.findActivity(\"\".concat(as, \"Dislike\")),\n  follows: (_, path) => path.findActivity(\"\".concat(as, \"Follow\")),\n  // Create activities\n  createActivity: new CreateActivityHandler(),\n  like: (_, path) => () => path.createActivity(\"\".concat(as, \"Like\")),\n  dislike: (_, path) => () => path.createActivity(\"\".concat(as, \"Dislike\")),\n  follow: (_, path) => () => path.createActivity(\"\".concat(as, \"Follow\")),\n  // Delete activities\n  deleteActivity: new DeleteActivityHandler(),\n  unlike: (_, path) => () => path.deleteActivity(\"\".concat(as, \"Like\")),\n  undislike: (_, path) => () => path.deleteActivity(\"\".concat(as, \"Dislike\")),\n  unfollow: (_, path) => () => path.deleteActivity(\"\".concat(as, \"Follow\"))\n}; // Creates an LDflex for Solid root path with the given settings\n\nexport default function createRootPath(defaultSettings) {\n  let rootPath = null; // Factory for data paths that start from a given subject\n\n  const subjectPathFactory = new PathFactory({\n    handlers: { ...subjectHandlers,\n      root: () => rootPath\n    },\n    resolvers: [contextResolver]\n  }); // Root path that resolves the first property access\n\n  rootPath = new PathFactory({\n    // Handlers of specific named properties\n    handlers: { ...defaultHandlers,\n      // The `from` function takes a source as input\n      from: new SourcePathHandler(subjectPathFactory),\n      // The `user` property starts a path with the current user as subject\n      user: new UserPathHandler(subjectPathFactory),\n      // Clears the cache for the given document (or everything, if undefined)\n      clearCache: ({\n        settings\n      }) => doc => settings.createQueryEngine().clearCache(doc),\n      // Expose the JSON-LD context\n      context: contextResolver\n    },\n    // Resolvers for all remaining properties\n    resolvers: [// `data[url]` starts a path with the property as subject\n    new SubjectPathResolver(subjectPathFactory)],\n    ...defaultSettings\n  }).create();\n  return rootPath;\n}"]},"metadata":{},"sourceType":"module"}