{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Mediator = void 0;\n/**\n * A mediator can mediate an action over a bus of actors.\n *\n * It does the following:\n * 1. Accepts an action in {@link Mediator#mediate}.\n * 2. Sends the action to the bus to test its applicability on all actors.\n * 3. It _mediates_ over these test results.\n * 4. It selects the _best_ actor.\n * 5. The action is run by the _best_ actor, and the result if returned.\n *\n * The _mediates_ and _best_ parts are filled in by subclasses of this abstract Mediator class.\n *\n * @template A The type of actor to mediator over.\n * @template I The input type of an actor.\n * @template T The test type of an actor.\n * @template O The output type of an actor.\n */\n\nclass Mediator {\n  /**\n   * All enumerable properties from the `args` object are inherited to this mediator.\n   *\n   * @param {IMediatorArgs<A extends Actor<I, T, O>, I extends IAction, T extends IActorTest,\n   * O extends IActorOutput>} args Arguments object\n   * @param {string} args.name The name for this mediator.\n   * @param {Bus<A extends Actor<I, T, O>, I extends IAction, T extends IActorTest, O extends IActorOutput>} args.bus\n   *        The bus this mediator will mediate over.\n   * @throws When required arguments are missing.\n   */\n  constructor(args) {\n    Object.assign(this, args);\n  }\n  /**\n   * Publish the given action in the bus.\n   *\n   * This will send the test action on all actors in the bus.\n   * All actor replies will be returned.\n   *\n   * @param {I} action The action to mediate for.\n   * @return {IActorReply<A extends Actor<I, T, O>, I extends IAction, T extends IActorTest, O extends IActorOutput>[]}\n   * The list of actor replies.\n   */\n\n\n  publish(action) {\n    // Test all actors in the bus\n    const actors = this.bus.publish(action);\n\n    if (actors.length === 0) {\n      throw new Error(`No actors are able to reply to a message in the bus ${this.bus.name}`);\n    }\n\n    return actors;\n  }\n  /**\n   * Mediate for the given action to get an actor.\n   *\n   * This will send the test action on all actors in the bus.\n   * The actor that tests _best_ will be returned.\n   *\n   * @param {I} action The action to mediate for.\n   * @return {Promise<O extends IActorOutput>} A promise that resolves to the _best_ actor.\n   */\n\n\n  async mediateActor(action) {\n    // Mediate to one actor and run that actor.\n    return await this.mediateWith(action, this.publish(action));\n  }\n  /**\n   * Mediate for the given action.\n   *\n   * This will send the test action on all actors in the bus.\n   * The action will be run on the actor that tests _best_,\n   * of which the result will be returned.\n   *\n   * @param {I} action The action to mediate for.\n   * @return {Promise<O extends IActorOutput>} A promise that resolves to the mediation result.\n   */\n\n\n  async mediate(action) {\n    // Mediate to one actor and run the action on it\n    const actor = await this.mediateActor(action);\n    return actor.runObservable(action);\n  }\n\n}\n\nexports.Mediator = Mediator;","map":{"version":3,"sources":["/Users/mark/localRepos/StarBrightlyShining/node_modules/@comunica/core/lib/Mediator.js"],"names":["Object","defineProperty","exports","value","Mediator","constructor","args","assign","publish","action","actors","bus","length","Error","name","mediateActor","mediateWith","mediate","actor","runObservable"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,QAAR,GAAmB,KAAK,CAAxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAMA,QAAN,CAAe;AACX;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIC,EAAAA,WAAW,CAACC,IAAD,EAAO;AACdN,IAAAA,MAAM,CAACO,MAAP,CAAc,IAAd,EAAoBD,IAApB;AACH;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIE,EAAAA,OAAO,CAACC,MAAD,EAAS;AACZ;AACA,UAAMC,MAAM,GAAG,KAAKC,GAAL,CAASH,OAAT,CAAiBC,MAAjB,CAAf;;AACA,QAAIC,MAAM,CAACE,MAAP,KAAkB,CAAtB,EAAyB;AACrB,YAAM,IAAIC,KAAJ,CAAW,uDAAsD,KAAKF,GAAL,CAASG,IAAK,EAA/E,CAAN;AACH;;AACD,WAAOJ,MAAP;AACH;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACsB,QAAZK,YAAY,CAACN,MAAD,EAAS;AACvB;AACA,WAAO,MAAM,KAAKO,WAAL,CAAiBP,MAAjB,EAAyB,KAAKD,OAAL,CAAaC,MAAb,CAAzB,CAAb;AACH;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACiB,QAAPQ,OAAO,CAACR,MAAD,EAAS;AAClB;AACA,UAAMS,KAAK,GAAG,MAAM,KAAKH,YAAL,CAAkBN,MAAlB,CAApB;AACA,WAAOS,KAAK,CAACC,aAAN,CAAoBV,MAApB,CAAP;AACH;;AA3DU;;AA6DfP,OAAO,CAACE,QAAR,GAAmBA,QAAnB","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Mediator = void 0;\n/**\n * A mediator can mediate an action over a bus of actors.\n *\n * It does the following:\n * 1. Accepts an action in {@link Mediator#mediate}.\n * 2. Sends the action to the bus to test its applicability on all actors.\n * 3. It _mediates_ over these test results.\n * 4. It selects the _best_ actor.\n * 5. The action is run by the _best_ actor, and the result if returned.\n *\n * The _mediates_ and _best_ parts are filled in by subclasses of this abstract Mediator class.\n *\n * @template A The type of actor to mediator over.\n * @template I The input type of an actor.\n * @template T The test type of an actor.\n * @template O The output type of an actor.\n */\nclass Mediator {\n    /**\n     * All enumerable properties from the `args` object are inherited to this mediator.\n     *\n     * @param {IMediatorArgs<A extends Actor<I, T, O>, I extends IAction, T extends IActorTest,\n     * O extends IActorOutput>} args Arguments object\n     * @param {string} args.name The name for this mediator.\n     * @param {Bus<A extends Actor<I, T, O>, I extends IAction, T extends IActorTest, O extends IActorOutput>} args.bus\n     *        The bus this mediator will mediate over.\n     * @throws When required arguments are missing.\n     */\n    constructor(args) {\n        Object.assign(this, args);\n    }\n    /**\n     * Publish the given action in the bus.\n     *\n     * This will send the test action on all actors in the bus.\n     * All actor replies will be returned.\n     *\n     * @param {I} action The action to mediate for.\n     * @return {IActorReply<A extends Actor<I, T, O>, I extends IAction, T extends IActorTest, O extends IActorOutput>[]}\n     * The list of actor replies.\n     */\n    publish(action) {\n        // Test all actors in the bus\n        const actors = this.bus.publish(action);\n        if (actors.length === 0) {\n            throw new Error(`No actors are able to reply to a message in the bus ${this.bus.name}`);\n        }\n        return actors;\n    }\n    /**\n     * Mediate for the given action to get an actor.\n     *\n     * This will send the test action on all actors in the bus.\n     * The actor that tests _best_ will be returned.\n     *\n     * @param {I} action The action to mediate for.\n     * @return {Promise<O extends IActorOutput>} A promise that resolves to the _best_ actor.\n     */\n    async mediateActor(action) {\n        // Mediate to one actor and run that actor.\n        return await this.mediateWith(action, this.publish(action));\n    }\n    /**\n     * Mediate for the given action.\n     *\n     * This will send the test action on all actors in the bus.\n     * The action will be run on the actor that tests _best_,\n     * of which the result will be returned.\n     *\n     * @param {I} action The action to mediate for.\n     * @return {Promise<O extends IActorOutput>} A promise that resolves to the mediation result.\n     */\n    async mediate(action) {\n        // Mediate to one actor and run the action on it\n        const actor = await this.mediateActor(action);\n        return actor.runObservable(action);\n    }\n}\nexports.Mediator = Mediator;\n//# sourceMappingURL=Mediator.js.map"]},"metadata":{},"sourceType":"script"}