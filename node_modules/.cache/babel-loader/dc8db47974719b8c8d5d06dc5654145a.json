{"ast":null,"code":"var _jsxFileName = \"/Users/mark/localRepos/StarBrightlyShining/src/containers/app.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport update from 'immutability-helper';\nimport { registerTraversal, traverse, setTraversalObjectives, checkTraversalObjectives } from 'meld-clients-core/lib/actions/index';\nimport { prefix as pref } from 'meld-clients-core/lib/library/prefixes';\nimport { fetchGraph } from 'meld-clients-core/lib/actions/index';\nimport VersionPane from './versionPane';\nimport VersionListing from './versionListing';\nimport WorkListing from './workListing';\nimport SelectableScore from 'selectable-score/lib/selectable-score';\nimport NextPageButton from 'selectable-score/lib/next-page-button.js';\nimport PrevPageButton from 'selectable-score/lib/prev-page-button.js';\nimport SubmitButton from 'selectable-score/lib/submit-button.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MAX_TRAVERSERS = 5; // selectionString: CSS selector for all elements to be selectable (e.g. \".measure\", \".note\")\n//const selectorString = \".measure\";\n//const selectorString = \".notehead\";\n\nconst selectorStrings = {\n  note: \".notehead, .stem, .verse\",\n  measure: \".measure\"\n};\npref.bith = \"https://example.com/\";\npref.bithTerms = \"https://example.com/Terms/\";\npref.bibo = \"http://purl.org/ontology/bibo/\";\npref.gndo = \"https://d-nb.info/standards/elementset/gnd#\";\npref.dce = \"http://purl.org/dc/elements/1.1/\";\npref.dbpedia = \"https://dbpedia.org/ontology/\";\npref.rdau = \"http://rdaregistry.info/Elements/u/\";\npref.wdt = \"https://www.wikidata.org/prop/direct/\";\npref.schema = \"http://schema.org/\";\nconst basicVrvOptions = {\n  scale: 45,\n  header: \"none\",\n  adjustPageHeight: 1,\n  pageHeight: 800,\n  pageWidth: 2200,\n  footer: \"none\",\n  unit: 6\n};\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      mode: 'work',\n      //\t\t\tmode: 'compare',\n      // mode: 'version',\n      versions: [false, false],\n      work: false,\n      worklist: [],\n      targetting: 'note',\n      multiSelect: false,\n      // selector: '.notehead, .stem, .verse',\n      selection: {},\n      width: 1200,\n      height: 800,\n      annotations: [],\n      uri: this.props.uri,\n      selectedAnnotation: false,\n      arrangements: false\n    };\n    this.handleScoreUpdate = this.handleScoreUpdate.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.selectMeasures = this.selectMeasures.bind(this);\n    this.selectNotes = this.selectNotes.bind(this);\n    this.usefulIdForChildElement = this.usefulIdForChildElement.bind(this);\n    this.makeMusicalMaterialFromSelection = this.makeMusicalMaterialFromSelection.bind(this);\n    this.makeSelectionJSONLDFromSelection = this.makeSelectionJSONLDFromSelection.bind(this);\n    this.makeExtractFromSelection = this.makeExtractFromSelection.bind(this);\n    this.renderVersionInList = this.renderVersionInList.bind(this);\n    this.renderWorkInList = this.renderWorkInList.bind(this);\n    this.handleAddVersionPane = this.handleAddVersionPane.bind(this);\n    this.handleSelectAnnotation = this.handleSelectAnnotation.bind(this);\n    this.handleChangeWork = this.handleChangeWork.bind(this);\n    this.transformArrangement = this.transformArrangement.bind(this);\n    this.props.setTraversalObjectives([{\n      \"@embed\": \"@always\",\n      \"http://rdaregistry.info/Elements/u/P60242\": {}\n    }, {\n      \"@type\": pref.bith + \"MusicalMaterial\"\n    }]);\n  } // Life cycle methods\n\n\n  componentDidMount() {\n    // See: https://reactjs.org/docs/react-component.html#componentdidmount\n    if (this.props.graphURI) {\n      this.props.registerTraversal(this.props.graphURI, {\n        numHops: 3,\n        followPropertyUri: [pref.bibo + \"shortTitle\", pref.dbpedia + \"genre\", \"@id\", \"@type\", \"@value\", pref.gndo + \"arranger\", pref.gndo + \"opusNumericDesignationOfMusicalWork\", pref.dce + \"publisher\", pref.gndo + \"dateOfPublication\", pref.frbr + \"embodiment\", pref.rdau + \"P60163\", pref.rdau + \"O60242\", pref.wdt + \"P217\", pref.rdfs + \"label\"],\n        ignoreObjectPrefix: [\"http://d-nb.info/gnd/\", \"http://rdaregistry.info/\"]\n      });\n    }\n\n    window.addEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  updateDimensions() {\n    this.setState({\n      width: document.documentElement.clientWidth,\n      height: document.documentElement.clientHeight\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    // See: https://reactjs.org/docs/react-component.html#componentdidupdate\n    if (prevProps && \"graph\" in prevProps) {\n      if (this.graphComponentDidUpdate(this.props, prevProps, prevState)) {\n        this.graphHasChanged();\n      }\n    }\n  } // labelForGenre(genre, language){\n  //     if (!genre || !(pref.schema+\"about\" in genre)) return \"\";\n  //      const name = genre [pref.schema+\"about\"][prefix.schema+\"name\"];\n  //     if ( Array.isArray(name) && name.length > 1 ){\n  //       return name.find(x => x[\"@language\"] === language)[\"@value\"];\n  //\n  //     } else if ( Array.isArray(name)){\n  //       return name[0][\"@value\"];\n  //     } else {\n  //       console.log (\"genre is not what we expected\", name);\n  //       return \"\";\n  //     }\n  // }\n\n\n  transformArrangement(vivoScore) {\n    // Take graph of arrangement and make more intuitive local object\n    let obj = {};\n    obj.shortTitle = vivoScore[pref.bibo + \"shortTitle\"]; // obj.genre = pref.dbpedia+\"genre\" in vivoScore ? vivoScore[pref.dbpedia+\"genre\"]['@id'] : false;\n    // obj.genre = this.labelForGenre(vivoScore[pref.dbpedia+\"genre\"], \"en\");\n\n    obj.arranger = vivoScore[pref.gndo + 'arranger']; // Change so we have name, not URL\n\n    obj.publisher = vivoScore[pref.dce + \"publisher\"]; // Change so we have name, not URL\n\n    obj.date = vivoScore[pref.gndo + \"dateOfPublication\"];\n    obj.MEI = pref.frbr + \"embodiment\" in vivoScore ? vivoScore[pref.frbr + \"embodiment\"]['@id'] : false;\n    obj.place = vivoScore[pref.rdau + \"P60163\"]; //    obj.catNumber = pref.wdt+\"P217\" in vivoScore ? vivoScore[pref.wdt+\"P217\"]['@id'] : false;\n\n    obj.catNumber = vivoScore[pref.wdt + \"P217\"];\n    obj.work = vivoScore[pref.rdau + \"P60242\"]; //\t\tconsole.log(\"Processed a \", vivoScore, \" into a \", obj);\n\n    return obj;\n  } // methods called during initialisation and graph loading\n\n\n  addWork(worklist, arrangement) {\n    if (!arrangement.work || !'@id' in arrangement.work) return workList;\n    const wID = arrangement.work['@id'];\n\n    if (worklist.find(x => x['@id'] === wID)) {\n      return worklist;\n    } else {\n      let wl2 = worklist.slice();\n      wl2.push(arrangement.work);\n      return wl2;\n    }\n  }\n\n  graphHasChanged() {\n    let arrangements = [];\n    let worklist = []; // 0. Get arrangements\n\n    if (this.props.graph && this.props.graph.outcomes && this.props.graph.outcomes[0] && this.props.graph.outcomes[0]['@graph'] && this.props.graph.outcomes[0]['@graph'].length) {\n      arrangements = this.props.graph.outcomes[0]['@graph'].map(this.transformArrangement); // Extract all unique works from the arrangements list\n\n      worklist = arrangements.reduce(this.addWork, []);\n    } // 1. convert this.graph.outcomes[0] into this.state.worklist\n\n\n    this.setState({\n      arrangements: arrangements,\n      worklist: worklist\n    });\n  }\n\n  graphComponentDidUpdate(props, prevProps, prevState) {\n    // Boiler plate traversal code (should move to m-c-c)\n    // Check whether the graph has updated and trigger further traversal as necessary.\n    // Called by this.componentDidUpdate\n    var prevPool = prevProps.traversalPool;\n    var thisPool = props.traversalPool;\n    var updated = false;\n\n    if (prevPool.running === 1 && thisPool.running === 0) {\n      // check our traversal objectives if the graph has updated\n      props.checkTraversalObjectives(props.graph.graph, props.graph.objectives);\n      updated = true;\n    } else if (Object.keys(thisPool.pool).length && thisPool.running < MAX_TRAVERSERS) {\n      // Initiate next traverser in pool...\n      var uri = Object.keys(thisPool.pool)[0];\n      props.traverse(uri, thisPool.pool[uri]);\n\n      if (prevProps.graph.outcomesHash !== props.graph.outcomesHash) {\n        updated = true;\n      }\n    } else if (props.traversalPool.running === 0) {\n      if (prevProps.graph.outcomesHash !== props.graph.outcomesHash) {\n        updated = true;\n      }\n    }\n\n    return updated;\n  } // UI methods\n\n\n  selectMeasures() {\n    this.setState({\n      targetting: 'measure'\n    });\n  }\n\n  selectNotes() {\n    this.setState({\n      targetting: 'note'\n    });\n  }\n\n  usefulIdForChildElement(element) {\n    if (element.classList.contains(this.state.targetting)) {\n      return element.id;\n    } else if (this.state.targetting === 'note' && element.classList.contains('chord')) {\n      // Ugly exception â€“ chords have a stem that applies to all notes\n      return Array.from(element.getElementsByClassName('note')).map(x => x.id);\n    } else if (!element.parentNode.parentNode) {\n      return false;\n    } else {\n      return this.usefulIdForChildElement(element.parentNode);\n    }\n  }\n\n  handleNoteSelectionChange(key, selection) {\n    // We need to replace this.state.selection[key] with the notes that contain newSelection\n    const selectionIds = selection.map(this.usefulIdForChildElement).flat();\n    this.handleSelectionChange(key, selectionIds);\n  }\n\n  handleMeasureSelectionChange(key, selection) {\n    // We need to replace this.state.selection[key] with the notes that contain newSelection\n    const selectionIds = selection.map(x => x.id);\n    this.handleSelectionChange(key, selectionIds);\n  }\n\n  handleSelectionChange(key, selectionIds) {\n    const pane = document.getElementById(key);\n\n    if (!pane) {\n      console.log(\"FAILED TO FIND\", key, selectionIds);\n      return;\n    }\n\n    const selectedElements = Array.from(pane.getElementsByClassName('selected'));\n    const newSelection = { ...this.state.selection\n    };\n    selectedElements.forEach(thing => thing.classList.remove('selected'));\n    selectionIds.forEach(e => document.getElementById(e).classList.add('selected'));\n    newSelection[key] = selectionIds;\n    this.setState({\n      selection: newSelection,\n      multiSelect: Object.keys(newSelection).length > 1 && Object.values(newSelection).filter(x => x.length).length > 1\n    });\n  }\n\n  handleSelectAnnotation(annotation) {\n    this.setState({\n      selectedAnnotation: annotation\n    });\n  }\n\n  addElementToSelectionObject(object, resourceURI, element) {\n    if (!(pref.frbr + \"part\" in object)) object[pref.frbr + \"part\"] = [];\n    object[pref.frbr + \"part\"].push(resourceURI + \"#\" + element);\n    return object;\n  }\n\n  makeSelectionJSONLDFromSelection(uri) {\n    const selectionObject = {\n      \"@type\": pref.bithTerms + \"Selection\"\n    };\n    this.state.selection[uri].forEach(this.addElementToSelectionObject.bind(this, selectionObject, uri));\n    return selectionObject;\n  }\n\n  makeExtractFromSelection(uri) {\n    const extractObject = {\n      \"@type\": pref.bithTerms + \"Extract\"\n    };\n    extractObject[pref.frbr + \"member\"] = [this.makeSelectionJSONLDFromSelection(uri)];\n    return extractObject;\n  }\n\n  makeMusicalMaterialFromSelection() {\n    const uris = Object.keys(this.state.selection);\n    const now = new Date();\n    let mm = {\n      \"@type\": pref.bithTerms + \"MusicalMaterial\"\n    };\n    mm[pref.dct + \"created\"] = now.toISOString();\n    mm[pref.frbr + \"embodiment\"] = uris.map(this.makeExtractFromSelection);\n    this.setState(update(this.state, {\n      annotations: {\n        $push: [mm]\n      }\n    }));\n  }\n\n  handleScoreUpdate(scoreElement) {\n    console.log(\"Received updated score DOM element: \", scoreElement);\n  }\n\n  handleChooseWork(work) {\n    this.setState({\n      mode: 'version',\n      work: work\n    });\n  }\n\n  handleChangeWork() {\n    this.setState({\n      mode: 'work',\n      work: false\n    });\n  }\n\n  handleChooseVersion(version) {\n    this.setState({\n      mode: 'score',\n      versions: [version, false]\n    });\n  }\n\n  handleReplaceVersion(version, replacePos) {\n    // Swap out one of the versions\n    let versions = this.state.versions.slice();\n    versions[replacePos] = version;\n    this.setState({\n      mode: 'compare',\n      versions: versions\n    });\n  }\n\n  handleAddVersionPane() {\n    this.setState({\n      mode: 'addVersion'\n    });\n  }\n\n  handleSubmit(args) {\n    /* do any app-specific actions and return the object (e.g. a Web Annotation)\n     * to be submitted to the user POD */\n    console.log(\"Received args: \", args);\n    return {\n      \"@context\": \"http://www.w3.org/ns/anno.jsonld\",\n      \"target\": this.state.selection.map(elem => this.state.uri + \"#\" + elem.getAttribute(\"id\")),\n      \"motivation\": \"highlighting\"\n    };\n  }\n\n  render() {\n    switch (this.state.mode) {\n      case 'version':\n        return this.renderVersions();\n\n      case 'addVersion':\n        return this.renderVersions();\n\n      case 'score':\n        return this.renderSingleScore();\n\n      case 'compare':\n        return this.renderTiledScores();\n\n      case 'work':\n      default:\n        return this.renderWorks();\n    }\n  } // renderWorkInList(work){\n  // \t// Each work is drawn separately to the works list\n  // \treturn <div className=\"workListing\" onClick={ this.handleChooseWork.bind(this, work) }>{ work.title}</div> ;\n  // }\n\n\n  renderWorkInList(work) {\n    const handler = this.handleChooseWork.bind(this, work);\n    return /*#__PURE__*/_jsxDEV(WorkListing, {\n      shortTitle: work[pref.rdfs + \"label\"],\n      composer: work[pref.rdau + \"P60426\"][pref.rdfs + \"label\"],\n      opus: work[pref.gndo + \"opusNumericDesignationOfMusicalWork\"],\n      date: work[pref.gndo + \"dateOfPublication\"],\n      clickHandler: handler\n    }, work['@id'], false, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 14\n    }, this);\n  }\n\n  renderVersionInList(version) {\n    // Each verison is drawn separately to the versions list\n    const handler = this.state.mode === \"version\" ? this.handleChooseVersion.bind(this, version) : this.handleReplaceVersion.bind(this, version, 1);\n    return /*#__PURE__*/_jsxDEV(VersionListing, {\n      clickHandler: handler,\n      ...version\n    }, version.shortTitle, false, {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 10\n    }, this);\n  }\n\n  renderWorks() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"works\",\n      children: this.state.worklist.map(this.renderWorkInList)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 4\n    }, this);\n  }\n\n  renderWorkAsHeader(work) {\n    if (!work) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"backButton\",\n        onClick: this.handleChangeWork,\n        children: \"Go Back - Change Work\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 11\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: this.handleChangeWork,\n        children: \"Go Back - Change Work\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 11\n      }, this);\n    }\n  }\n\n  renderVersions() {\n    if (!this.state.arrangements.length) return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 46\n    }, this);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"work\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"workInfo\",\n        children: this.renderWorkAsHeader(this.state.work)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"versions\",\n        children: this.state.work ? this.state.arrangements.filter(x => x.work['@id'] === this.state.work['@id']).map(this.renderVersionInList) : this.state.arrangements.map(this.renderVersionInList)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 4\n    }, this);\n  }\n\n  selectionRadioButton(target, callback) {\n    return /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"radio\",\n      name: \"target\",\n      checked: this.state.targetting === target,\n      className: this.state.targetting === target ? \"checked\" : \"unchecked\",\n      onChange: callback,\n      value: target,\n      id: target\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 10\n    }, this);\n  }\n\n  annotationButtons() {\n    if (this.state.multiSelect) {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"musicalMaterial annotationButton\",\n        onClick: this.makeMusicalMaterialFromSelection,\n        children: \"Parallel passages\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 5\n      }, this);\n    }\n  }\n\n  renderTiledScores() {\n    // MEI URIs hardwired for testing\n    if (!this.state.versions[0] && this.state.versions[1]) return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 64\n    }, this);\n    const upperURI = this.state.arrangements.length ? this.state.arrangements[0].MEI : \"https://meld.linkedmusic.org/companion/mei/F1.mei\"; //    const upperURI = \"https://raw.githubusercontent.com/DomesticBeethoven/data/main/op.%2092/ChorHallberger%20-%20D-BNba%20Nc%204_1846%20Schil/D-BNbaNc4_1846_Schil.mei>\";\n\n    const lowerURI = \"https://meld.linkedmusic.org/companion/mei/F2.mei\";\n    const upper = this.state.versions[0];\n    const lower = this.state.versions[1];\n    const selectionHandler = this.state.targetting === 'note' ? this.handleNoteSelectionChange : this.handleMeasureSelectionChange;\n    const narrowWindow = this.state.width < 800;\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"backButton\",\n        onclick: \"renderWorks()\",\n        children: \"Back Button\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"workInfo\",\n        children: this.renderWorkAsHeader(this.state.work)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Select:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"target switch-field\",\n        children: [this.selectionRadioButton('measure', this.selectMeasures), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"measure\",\n          children: \"Measures\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 6\n        }, this), this.selectionRadioButton('note', this.selectNotes), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"note\",\n          children: \"Notes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 5\n      }, this), this.annotationButtons(), /*#__PURE__*/_jsxDEV(VersionPane, {\n        extraClasses: \"upper\",\n        id: \"pane1\",\n        narrowPane: narrowWindow,\n        width: this.state.width,\n        uri: upper.MEI //  shortTitle=\"Star Brightly Shining\"\n        ,\n        shortTitle: upper.shortTitle,\n        arranger: \"Josiah Pittman\",\n        genre: \"Piano-vocal\",\n        publisher: \"Augener & Co.\",\n        date: upper.date,\n        place: \"London\",\n        catNumber: upper.catNumber,\n        vrvOptions: basicVrvOptions,\n        annotations: this.state.annotations,\n        selectionHandler: selectionHandler.bind(this, upper.MEI),\n        selectorString: selectorStrings[this.state.targetting],\n        handleSelectAnnotation: this.handleSelectAnnotation,\n        selectedAnnotation: this.state.selectedAnnotation,\n        handleScoreUpdate: this.handleScoreUpdate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(VersionPane, {\n        extraClasses: \"lower\",\n        width: this.state.width,\n        id: \"pane1\",\n        shortTitle: lower.shortTitle,\n        arranger: \"Friedrich Silcher\",\n        genre: \"Choral music\",\n        publisher: \"Hallberger\",\n        date: \"1846\",\n        place: \"Stuttgart\",\n        catNumber: lower.catNumber,\n        uri: lower.MEI,\n        annotations: this.state.annotations,\n        vrvOptions: basicVrvOptions,\n        handleSelectAnnotation: this.handleSelectAnnotation,\n        selectedAnnotation: this.state.selectedAnnotation,\n        selectionHandler: selectionHandler.bind(this, lower.MEI),\n        selectorString: selectorStrings[this.state.targetting],\n        handleScoreUpdate: this.handleScoreUpdate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 4\n    }, this);\n  }\n\n  renderSingleScore() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Current selection: \", this.state.selection.length > 0 ? /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\" \", this.state.selection.map(elem => elem.getAttribute(\"id\")).join(\", \"), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Nothing selected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(NextPageButton, {\n        buttonContent: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Next\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 29\n        }, this),\n        uri: this.state.uri\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 475,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(PrevPageButton, {\n        buttonContent: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Prev\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 482,\n          columnNumber: 29\n        }, this),\n        uri: this.state.uri\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 481,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"addPane\",\n        onClick: this.handleAddVersionPane,\n        children: \"+\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(SelectableScore, {\n        uri: this.state.versions[0].MEI,\n        options: this.props.vrvOptions,\n        onSelectionChange: this.handleSelectionChange,\n        selectorString: selectorStrings[this.state.targetting],\n        onScoreUpdate: this.handleScoreUpdate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 489,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 468,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nfunction mapStateToProps({\n  graph,\n  score,\n  traversalPool\n}) {\n  return {\n    graph,\n    score,\n    traversalPool\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators({\n    registerTraversal,\n    traverse,\n    setTraversalObjectives,\n    checkTraversalObjectives,\n    fetchGraph\n  }, dispatch);\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","map":{"version":3,"sources":["/Users/mark/localRepos/StarBrightlyShining/src/containers/app.js"],"names":["React","Component","connect","bindActionCreators","update","registerTraversal","traverse","setTraversalObjectives","checkTraversalObjectives","prefix","pref","fetchGraph","VersionPane","VersionListing","WorkListing","SelectableScore","NextPageButton","PrevPageButton","SubmitButton","MAX_TRAVERSERS","selectorStrings","note","measure","bith","bithTerms","bibo","gndo","dce","dbpedia","rdau","wdt","schema","basicVrvOptions","scale","header","adjustPageHeight","pageHeight","pageWidth","footer","unit","App","constructor","props","state","mode","versions","work","worklist","targetting","multiSelect","selection","width","height","annotations","uri","selectedAnnotation","arrangements","handleScoreUpdate","bind","handleSubmit","selectMeasures","selectNotes","usefulIdForChildElement","makeMusicalMaterialFromSelection","makeSelectionJSONLDFromSelection","makeExtractFromSelection","renderVersionInList","renderWorkInList","handleAddVersionPane","handleSelectAnnotation","handleChangeWork","transformArrangement","componentDidMount","graphURI","numHops","followPropertyUri","frbr","rdfs","ignoreObjectPrefix","window","addEventListener","updateDimensions","setState","document","documentElement","clientWidth","clientHeight","componentDidUpdate","prevProps","prevState","graphComponentDidUpdate","graphHasChanged","vivoScore","obj","shortTitle","arranger","publisher","date","MEI","place","catNumber","addWork","arrangement","workList","wID","find","x","wl2","slice","push","graph","outcomes","length","map","reduce","prevPool","traversalPool","thisPool","updated","running","objectives","Object","keys","pool","outcomesHash","element","classList","contains","id","Array","from","getElementsByClassName","parentNode","handleNoteSelectionChange","key","selectionIds","flat","handleSelectionChange","handleMeasureSelectionChange","pane","getElementById","console","log","selectedElements","newSelection","forEach","thing","remove","e","add","values","filter","annotation","addElementToSelectionObject","object","resourceURI","selectionObject","extractObject","uris","now","Date","mm","dct","toISOString","$push","scoreElement","handleChooseWork","handleChooseVersion","version","handleReplaceVersion","replacePos","args","elem","getAttribute","render","renderVersions","renderSingleScore","renderTiledScores","renderWorks","handler","renderWorkAsHeader","selectionRadioButton","target","callback","annotationButtons","upperURI","lowerURI","upper","lower","selectionHandler","narrowWindow","join","vrvOptions","mapStateToProps","score","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux' ;\nimport { bindActionCreators } from 'redux';\nimport update from 'immutability-helper';\nimport { registerTraversal, traverse, setTraversalObjectives, checkTraversalObjectives } from 'meld-clients-core/lib/actions/index';\nimport { prefix as pref } from 'meld-clients-core/lib/library/prefixes';\nimport { fetchGraph } from 'meld-clients-core/lib/actions/index';\nimport VersionPane from './versionPane';\nimport VersionListing from './versionListing';\nimport WorkListing from './workListing';\nimport SelectableScore from 'selectable-score/lib/selectable-score';\nimport NextPageButton from 'selectable-score/lib/next-page-button.js';\nimport PrevPageButton from 'selectable-score/lib/prev-page-button.js';\nimport SubmitButton from 'selectable-score/lib/submit-button.js';\n\nconst MAX_TRAVERSERS = 5;\n\n// selectionString: CSS selector for all elements to be selectable (e.g. \".measure\", \".note\")\n//const selectorString = \".measure\";\n//const selectorString = \".notehead\";\nconst selectorStrings = { note: \".notehead, .stem, .verse\", measure: \".measure\" };\n\npref.bith = \"https://example.com/\";\npref.bithTerms = \"https://example.com/Terms/\";\npref.bibo = \"http://purl.org/ontology/bibo/\";\npref.gndo = \"https://d-nb.info/standards/elementset/gnd#\";\npref.dce = \"http://purl.org/dc/elements/1.1/\";\npref.dbpedia = \"https://dbpedia.org/ontology/\";\npref.rdau = \"http://rdaregistry.info/Elements/u/\";\npref.wdt = \"https://www.wikidata.org/prop/direct/\";\npref.schema = \"http://schema.org/\";\n\nconst basicVrvOptions = {\n  scale: 45,\n\theader: \"none\",\n  adjustPageHeight: 1,\n  pageHeight: 800,\n  pageWidth: 2200,\n  footer: \"none\",\n  unit: 6\n};\n\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n\t\t\tmode: 'work',\n\t\t\t//\t\t\tmode: 'compare',\n\t\t\t// mode: 'version',\n\t\t\tversions: [false, false],\n\t\t\twork: false,\n\t\t\tworklist: [],\n\t\t\ttargetting: 'note',\n\t\t\tmultiSelect: false,\n\t\t\t// selector: '.notehead, .stem, .verse',\n      selection: {},\n\t\t\twidth: 1200,\n\t\t\theight: 800,\n\t\t\tannotations: [],\n      uri: this.props.uri,\n\t\t\tselectedAnnotation: false,\n      arrangements: false\n    };\n    this.handleScoreUpdate = this.handleScoreUpdate.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n\t\tthis.selectMeasures = this.selectMeasures.bind(this);\n\t\tthis.selectNotes = this.selectNotes.bind(this);\n\t\tthis.usefulIdForChildElement = this.usefulIdForChildElement.bind(this);\n\t\tthis.makeMusicalMaterialFromSelection = this.makeMusicalMaterialFromSelection.bind(this);\n\t\tthis.makeSelectionJSONLDFromSelection = this.makeSelectionJSONLDFromSelection.bind(this);\n\t\tthis.makeExtractFromSelection = this.makeExtractFromSelection.bind(this);\n\t\tthis.renderVersionInList = this.renderVersionInList.bind(this);\n\t\tthis.renderWorkInList = this.renderWorkInList.bind(this);\n\t\tthis.handleAddVersionPane = this.handleAddVersionPane.bind(this);\n\t\tthis.handleSelectAnnotation = this.handleSelectAnnotation.bind(this);\n    this.handleChangeWork = this.handleChangeWork.bind(this);\n    this.transformArrangement = this.transformArrangement.bind(this);\n\t\tthis.props.setTraversalObjectives([\n\t\t\t{\n\t\t\t\t\"@embed\": \"@always\",\n\t\t\t\t\"http://rdaregistry.info/Elements/u/P60242\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"@type\": pref.bith + \"MusicalMaterial\"\n\t\t\t}\n\t\t]);\n\t}\n\t// Life cycle methods\n\tcomponentDidMount(){\n    // See: https://reactjs.org/docs/react-component.html#componentdidmount\n    if(this.props.graphURI){\n      this.props.registerTraversal(this.props.graphURI,\n\t\t\t\t\t {numHops: 3,\n\t\t\t\t\t\tfollowPropertyUri: [pref.bibo+\"shortTitle\", pref.dbpedia+\"genre\", \"@id\", \"@type\", \"@value\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpref.gndo+\"arranger\", pref.gndo+\"opusNumericDesignationOfMusicalWork\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpref.dce+\"publisher\", pref.gndo+\"dateOfPublication\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpref.frbr+\"embodiment\", pref.rdau+\"P60163\", pref.rdau+\"O60242\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpref.wdt+\"P217\",pref.rdfs+\"label\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\tignoreObjectPrefix: [\"http://d-nb.info/gnd/\", \"http://rdaregistry.info/\"]});\n    }\n\t\twindow.addEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n  updateDimensions() {\n\t\tthis.setState({width: document.documentElement.clientWidth,\n\t\t\t\t\t\t\t\t\t height: document.documentElement.clientHeight});\n  }\n\n  componentDidUpdate(prevProps, prevState){\n    // See: https://reactjs.org/docs/react-component.html#componentdidupdate\n    if(prevProps && \"graph\" in prevProps) {\n      if ( this.graphComponentDidUpdate(this.props, prevProps, prevState ) ) {\n\t\t\t\tthis.graphHasChanged();\n      }\n    }\n\t}\n\n  // labelForGenre(genre, language){\n  //     if (!genre || !(pref.schema+\"about\" in genre)) return \"\";\n  //      const name = genre [pref.schema+\"about\"][prefix.schema+\"name\"];\n  //     if ( Array.isArray(name) && name.length > 1 ){\n  //       return name.find(x => x[\"@language\"] === language)[\"@value\"];\n  //\n  //     } else if ( Array.isArray(name)){\n  //       return name[0][\"@value\"];\n  //     } else {\n  //       console.log (\"genre is not what we expected\", name);\n  //       return \"\";\n  //     }\n  // }\n\ttransformArrangement(vivoScore){\n\t\t// Take graph of arrangement and make more intuitive local object\n\t\tlet obj = {};\n\t\tobj.shortTitle = vivoScore[pref.bibo+\"shortTitle\"];\n\n\t\t// obj.genre = pref.dbpedia+\"genre\" in vivoScore ? vivoScore[pref.dbpedia+\"genre\"]['@id'] : false;\n    // obj.genre = this.labelForGenre(vivoScore[pref.dbpedia+\"genre\"], \"en\");\n\n\t\tobj.arranger = vivoScore[pref.gndo+'arranger']; // Change so we have name, not URL\n\t\tobj.publisher = vivoScore[pref.dce+\"publisher\"]; // Change so we have name, not URL\n\t\tobj.date = vivoScore[pref.gndo+\"dateOfPublication\"];\n\t\tobj.MEI = pref.frbr+\"embodiment\" in vivoScore ? vivoScore[pref.frbr+\"embodiment\"]['@id'] : false;\n\t\tobj.place = vivoScore[pref.rdau+\"P60163\"];\n//    obj.catNumber = pref.wdt+\"P217\" in vivoScore ? vivoScore[pref.wdt+\"P217\"]['@id'] : false;\n    obj.catNumber = vivoScore[pref.wdt+\"P217\"];\n\t\tobj.work = vivoScore[pref.rdau+\"P60242\"];\n//\t\tconsole.log(\"Processed a \", vivoScore, \" into a \", obj);\n\t\treturn obj;\n\t}\n\t// methods called during initialisation and graph loading\n\taddWork(worklist, arrangement){\n\t\tif(!arrangement.work || !'@id' in arrangement.work) return workList;\n\t\tconst wID = arrangement.work['@id'];\n\t\tif(worklist.find(x => x['@id']===wID)){\n\t\t\treturn worklist;\n\t\t} else {\n\t\t\tlet wl2 = worklist.slice();\n\t\t\twl2.push(arrangement.work);\n\t\t\treturn wl2;\n\t\t}\n\t}\n\tgraphHasChanged(){\n\t\tlet arrangements = [];\n\t\tlet worklist = [];\n\t\t// 0. Get arrangements\n\t\tif(this.props.graph && this.props.graph.outcomes\n\t\t\t && this.props.graph.outcomes[0]\n\t\t\t && this.props.graph.outcomes[0]['@graph']\n\t\t\t && this.props.graph.outcomes[0]['@graph'].length){\n\t\t\tarrangements = this.props.graph.outcomes[0]['@graph'].map(this.transformArrangement);\n\t\t\t// Extract all unique works from the arrangements list\n\t\t\tworklist = arrangements.reduce(this.addWork, []);\n\t\t}\n\t\t// 1. convert this.graph.outcomes[0] into this.state.worklist\n    this.setState({arrangements: arrangements, worklist: worklist});\n\t}\n\n  graphComponentDidUpdate(props, prevProps, prevState) {\n\t\t// Boiler plate traversal code (should move to m-c-c)\n\t\t// Check whether the graph has updated and trigger further traversal as necessary.\n\t\t// Called by this.componentDidUpdate\n    var prevPool = prevProps.traversalPool;\n    var thisPool = props.traversalPool;\n    var updated  = false;\n    if (prevPool.running === 1 && thisPool.running ===0){\n      // check our traversal objectives if the graph has updated\n      props.checkTraversalObjectives(\n        props.graph.graph, props.graph.objectives);\n      updated = true;\n    } else if ( Object.keys(thisPool.pool).length && thisPool.running < MAX_TRAVERSERS) {\n      // Initiate next traverser in pool...\n      var uri = Object.keys(thisPool.pool)[0];\n      props.traverse(uri, thisPool.pool[uri]);\n      if (prevProps.graph.outcomesHash !== props.graph.outcomesHash) {\n        updated = true;\n      }\n    } else if ( props.traversalPool.running===0 ) {\n      if(prevProps.graph.outcomesHash !== props.graph.outcomesHash) {\n        updated = true;\n      }\n    }\n    return updated;\n  }\n\n\t// UI methods\n\n\tselectMeasures(){\n\t\tthis.setState({targetting: 'measure'});\n\t}\n\tselectNotes(){\n\t\tthis.setState({targetting: 'note'});\n\t}\n\n\tusefulIdForChildElement(element) {\n\t\tif(element.classList.contains(this.state.targetting)){\n\t\t\treturn element.id;\n\t\t} else if(this.state.targetting==='note' && element.classList.contains('chord')){\n\t\t\t// Ugly exception â€“ chords have a stem that applies to all notes\n\t\t\treturn Array.from(element.getElementsByClassName('note')).map(x => x.id);\n\t\t} else if(!element.parentNode.parentNode) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn this.usefulIdForChildElement(element.parentNode);\n\t\t}\n\t}\n  handleNoteSelectionChange(key, selection) {\n\t\t// We need to replace this.state.selection[key] with the notes that contain newSelection\n\t\tconst selectionIds = selection.map(this.usefulIdForChildElement).flat();\n\t\tthis.handleSelectionChange(key, selectionIds);\n  }\n  handleMeasureSelectionChange(key, selection) {\n\t\t// We need to replace this.state.selection[key] with the notes that contain newSelection\n\t\tconst selectionIds = selection.map(x => x.id);\n\t\tthis.handleSelectionChange(key, selectionIds);\n  }\n\thandleSelectionChange(key, selectionIds){\n\t\tconst pane = document.getElementById(key);\n\t\tif(!pane){\n\t\t\tconsole.log(\"FAILED TO FIND\", key, selectionIds);\n\t\t\treturn;\n\t\t}\n\t\tconst selectedElements = Array.from(pane.getElementsByClassName('selected'));\n\t\tconst newSelection = {...this.state.selection};\n\t\tselectedElements.forEach(thing => thing.classList.remove('selected'));\n\t\tselectionIds.forEach(e => document.getElementById(e).classList.add('selected'));\n\t\tnewSelection[key] = selectionIds;\n    this.setState({ selection: newSelection,\n\t\t\t\t\t\t\t\t\t\tmultiSelect: (Object.keys(newSelection).length > 1\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&& Object.values(newSelection).filter(x => x.length).length > 1) });\n\t}\n\thandleSelectAnnotation(annotation){\n\t\tthis.setState({selectedAnnotation: annotation});\n\t}\n\taddElementToSelectionObject(object, resourceURI, element) {\n\t\tif(!((pref.frbr+\"part\") in object)) object[pref.frbr+\"part\"] = [];\n\t\tobject[pref.frbr+\"part\"].push(resourceURI+\"#\"+element);\n\t\treturn object;\n\t}\n\tmakeSelectionJSONLDFromSelection(uri){\n\t\tconst selectionObject = {\"@type\": pref.bithTerms+\"Selection\"};\n\t\tthis.state.selection[uri].forEach(this.addElementToSelectionObject.bind(this, selectionObject, uri));\n\t\treturn selectionObject;\n\t}\n\tmakeExtractFromSelection(uri){\n\t\tconst extractObject = {\"@type\": pref.bithTerms+\"Extract\"};\n\t\textractObject[pref.frbr+\"member\"] = [this.makeSelectionJSONLDFromSelection(uri)];\n\t\treturn extractObject;\n\t}\n\tmakeMusicalMaterialFromSelection(){\n\t\tconst uris = Object.keys(this.state.selection);\n\t\tconst now = new Date();\n\t\tlet mm = {\"@type\": pref.bithTerms+\"MusicalMaterial\"};\n\t\tmm[pref.dct+\"created\"] = now.toISOString();\n\t\tmm[pref.frbr+\"embodiment\"] = uris.map(this.makeExtractFromSelection);\n\t\tthis.setState(update(this.state, {annotations: {$push: [mm]}}));\n\t}\n  handleScoreUpdate(scoreElement) {\n    console.log(\"Received updated score DOM element: \", scoreElement)\n  }\n\n\thandleChooseWork(work){\n\t\tthis.setState({mode: 'version', work: work });\n  }\n  handleChangeWork(){\n    this.setState({mode: 'work', work: false});\n  }\n\n\thandleChooseVersion(version){\n\t\tthis.setState({mode: 'score', versions: [version, false]});\n\t}\n\thandleReplaceVersion(version, replacePos){\n\t\t// Swap out one of the versions\n\t\tlet versions = this.state.versions.slice();\n\t\tversions[replacePos] = version;\n\t\tthis.setState({mode: 'compare', versions: versions});\n\t}\n\thandleAddVersionPane(){\n\t\tthis.setState({mode: 'addVersion'});\n\t}\n  handleSubmit(args) {\n    /* do any app-specific actions and return the object (e.g. a Web Annotation)\n     * to be submitted to the user POD */\n    console.log(\"Received args: \", args);\n    return {\n      \"@context\": \"http://www.w3.org/ns/anno.jsonld\",\n      \"target\": this.state.selection.map( (elem) => this.state.uri + \"#\" + elem.getAttribute(\"id\") ),\n      \"motivation\": \"highlighting\"\n    }\n  }\n\trender(){\n\t\tswitch(this.state.mode){\n\t\t\tcase 'version':\n\t\t\t\treturn this.renderVersions();\n\t\t\tcase 'addVersion':\n\t\t\t\treturn this.renderVersions();\n\t\t\tcase 'score':\n\t\t\t\treturn this.renderSingleScore();\n\t\t\tcase 'compare':\n\t\t\t\treturn this.renderTiledScores();\n\t\t\tcase 'work':\n\t\t\tdefault:\n\t\t\t\treturn this.renderWorks();\n\t\t}\n\t}\n\t// renderWorkInList(work){\n\t// \t// Each work is drawn separately to the works list\n\t// \treturn <div className=\"workListing\" onClick={ this.handleChooseWork.bind(this, work) }>{ work.title}</div> ;\n\t// }\n\n  renderWorkInList(work){\n      const handler = this.handleChooseWork.bind(this, work) ;\n      return <WorkListing key={work['@id']}\n\n                          shortTitle={work[pref.rdfs+\"label\"]}\n                          composer={work[pref.rdau+\"P60426\"][pref.rdfs+\"label\"]}\n                          opus={work[pref.gndo+\"opusNumericDesignationOfMusicalWork\"]}\n                          date={work[pref.gndo+\"dateOfPublication\"]}\n                          clickHandler={ handler } />;\n  }\n\n\trenderVersionInList(version){\n\t\t// Each verison is drawn separately to the versions list\n\t\tconst handler = this.state.mode===\"version\" ? this.handleChooseVersion.bind(this, version)\n\t\t\t\t\t: this.handleReplaceVersion.bind(this, version, 1)\n\t\treturn <VersionListing key={version.shortTitle}\n\t\t\t\t\t\t\t\t\t\t\t\t\t clickHandler={ handler } {...version}/>;\n\t}\n\trenderWorks(){\n\t\treturn (\n\t\t\t<div className=\"works\">\n\t\t\t\t{ this.state.worklist.map(this.renderWorkInList) }\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderWorkAsHeader(work){\n\t\tif(!work){\n\t\t\treturn <div className=\"backButton\"onClick={this.handleChangeWork}>Go Back - Change Work</div>;\n\t\t} else {\n\t\t\treturn <div onClick={this.handleChangeWork}>Go Back - Change Work</div>;\n\t\t}\n\t}\n\trenderVersions(){\n\t\tif(!this.state.arrangements.length) return <div>Loading...</div>;\n\t\treturn (\n\t\t\t<div className=\"work\">\n\t\t\t\t<div className=\"workInfo\">{this.renderWorkAsHeader(this.state.work)}</div>\n\t\t\t\t<div className=\"versions\">\n\t\t\t\t\t{ this.state.work ?\n\t\t\t\t\t\tthis.state.arrangements.filter(x=> x.work['@id']===this.state.work['@id']).map(this.renderVersionInList) :\n\t\t\t\t\t\tthis.state.arrangements.map(this.renderVersionInList) }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\tselectionRadioButton(target, callback){\n\t\treturn <input type=\"radio\" name=\"target\" checked={this.state.targetting===target}\n\t\t\t\t\t\t\t\t\tclassName={this.state.targetting===target ? \"checked\" : \"unchecked\" }\n\t\t\t\t\t\t\t\t\tonChange={callback}\n\t\t\t\t\t\t\t\t\tvalue={target} id={target} /> ;\n\t}\n\tannotationButtons(){\n\t\tif(this.state.multiSelect){\n\t\t\treturn (\n\t\t\t\t<button className=\"musicalMaterial annotationButton\"\n\t\t\t\t\t\t onClick={ this.makeMusicalMaterialFromSelection } >\n\t\t\t\t\tParallel passages\n\t\t\t\t</button>\n\t\t\t);\n\t\t}\n\t}\n\trenderTiledScores(){\n\t\t// MEI URIs hardwired for testing\n\t\tif(!this.state.versions[0] && this.state.versions[1]) return <div>Loading...</div>;\n\t\tconst upperURI = this.state.arrangements.length ? this.state.arrangements[0].MEI : \"https://meld.linkedmusic.org/companion/mei/F1.mei\";\n//    const upperURI = \"https://raw.githubusercontent.com/DomesticBeethoven/data/main/op.%2092/ChorHallberger%20-%20D-BNba%20Nc%204_1846%20Schil/D-BNbaNc4_1846_Schil.mei>\";\n\t\tconst lowerURI = \"https://meld.linkedmusic.org/companion/mei/F2.mei\";\n\t\tconst upper = this.state.versions[0];\n\t\tconst lower = this.state.versions[1];\n\t\tconst selectionHandler = this.state.targetting==='note' ?\n\t\t\t\t\tthis.handleNoteSelectionChange :\n\t\t\t\t\tthis.handleMeasureSelectionChange ;\n\t\tconst narrowWindow = this.state.width < 800;\n\t\treturn(\n\n\t\t\t<main>\n\n      <div className=\"backButton\"\n         onclick=\"renderWorks()\">\n        Back Button\n      </div>\n\t\t\t\t<div className=\"workInfo\">{this.renderWorkAsHeader(this.state.work)}</div>\n\t\t\t\t<h4>Select:</h4>\n\n\n\t\t\t\t<div className=\"target switch-field\">\n\t\t\t\t\t{ this.selectionRadioButton('measure', this.selectMeasures) }\n\t\t\t\t\t<label htmlFor=\"measure\">Measures</label>\n\t\t\t\t\t{ this.selectionRadioButton('note', this.selectNotes) }\n\t\t\t\t\t<label htmlFor=\"note\">Notes</label>\n\t\t\t\t</div>\n\n\t\t\t\t{this.annotationButtons()}\n\t\t\t\t<VersionPane extraClasses=\"upper\"\n\t\t\t\t\t\t\t\t\t\t id=\"pane1\"\n\t\t\t\t\t\t\t\t\t\t narrowPane={ narrowWindow }\n\t\t\t\t\t\t\t\t\t\t width={ this.state.width }\n\t\t\t\t\t\t\t\t\t\t uri={ upper.MEI }\n\t\t\t\t\t\t\t\t\t\t //  shortTitle=\"Star Brightly Shining\"\n                     shortTitle={ upper.shortTitle}\n                     arranger=\"Josiah Pittman\"\n                     genre=\"Piano-vocal\"\n                     publisher=\"Augener & Co.\"\n                     date={ upper.date}\n                     place=\"London\"\n                     catNumber={ upper.catNumber}\n\t\t\t\t\t\t\t\t\t\t vrvOptions={ basicVrvOptions }\n\t\t\t\t\t\t\t\t\t\t annotations= {this.state.annotations}\n\t\t\t\t\t\t\t\t\t\t selectionHandler={ selectionHandler.bind(this, upper.MEI) }\n\t\t\t\t\t\t\t\t\t\t selectorString={ selectorStrings[this.state.targetting] }\n\t\t\t\t\t\t\t\t\t\t handleSelectAnnotation={ this.handleSelectAnnotation }\n\t\t\t\t\t\t\t\t\t\t selectedAnnotation={this.state.selectedAnnotation}\n\t\t\t\t\t\t\t\t\t\t handleScoreUpdate={ this.handleScoreUpdate } />\n\t\t\t\t<VersionPane extraClasses=\"lower\"\n\t\t\t\t\t\t\t\t\t\t width={ this.state.width }\n\t\t\t\t\t\t\t\t\t\t id=\"pane1\"\n                     shortTitle={lower.shortTitle}\n                     arranger=\"Friedrich Silcher\"\n                     genre=\"Choral music\"\n                     publisher=\"Hallberger\"\n                     date=\"1846\"\n                     place=\"Stuttgart\"\n                     catNumber={ lower.catNumber}\n\t\t\t\t\t\t\t\t\t\t uri={ lower.MEI }\n\t\t\t\t\t\t\t\t\t\t annotations= {this.state.annotations}\n\t\t\t\t\t\t\t\t\t\t vrvOptions={ basicVrvOptions }\n\t\t\t\t\t\t\t\t\t\t handleSelectAnnotation={ this.handleSelectAnnotation }\n\t\t\t\t\t\t\t\t\t\t selectedAnnotation={this.state.selectedAnnotation}\n\t\t\t\t\t\t\t\t\t\t selectionHandler={ selectionHandler.bind(this, lower.MEI) }\n\t\t\t\t\t\t\t\t\t\t selectorString={ selectorStrings[this.state.targetting] }\n\t\t\t\t\t\t\t\t\t\t handleScoreUpdate={ this.handleScoreUpdate } />\n\t\t\t</main>\n\t\t);\n\t}\n  renderSingleScore() {\n    return(\n      <div>\n        <p>Current selection: { this.state.selection.length > 0\n          ? <span> { this.state.selection.map( (elem) => elem.getAttribute(\"id\") ).join(\", \") } </span>\n          : <span>Nothing selected</span>\n        }</p>\n\n        { /* pass anything as buttonContent that you'd like to function as a clickable next page button */ }\n        <NextPageButton\n          buttonContent = { <span>Next</span> }\n          uri = { this.state.uri }\n        />\n\n        { /* pass anything as buttonContent that you'd like to function as a clickable prev page button */ }\n        <PrevPageButton\n          buttonContent = { <span>Prev</span> }\n          uri = { this.state.uri }\n        />\n\t\t\t\t<button className=\"addPane\" onClick={this.handleAddVersionPane}>\n\t\t\t\t\t+\n\t\t\t\t</button>\n\n        <SelectableScore\n          uri={ this.state.versions[0].MEI }\n          options={ this.props.vrvOptions }\n          onSelectionChange={ this.handleSelectionChange }\n          selectorString = { selectorStrings[this.state.targetting] }\n          onScoreUpdate = { this.handleScoreUpdate }\n        />\n      </div>\n    )\n  }\n}\n\nfunction mapStateToProps({ graph , score, traversalPool}) {\n    return { graph , score, traversalPool };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return bindActionCreators({ registerTraversal, traverse,\n                                setTraversalObjectives, checkTraversalObjectives, fetchGraph },\n                              dispatch);\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"]},"metadata":{},"sourceType":"module"}