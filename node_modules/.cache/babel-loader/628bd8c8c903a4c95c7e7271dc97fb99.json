{"ast":null,"code":"import ActivityHandler from './ActivityHandler';\n/* babel-plugin-inline-import './activity-triples.sparql' */\n\nconst queryTemplate = \"SELECT ?subject ?predicate ?object WHERE {\\n  ?subject a _:type;\\n      <https://www.w3.org/ns/activitystreams#actor> _:actor;\\n      <https://www.w3.org/ns/activitystreams#object> _:object.\\n  ?subject ?predicate ?object.\\n}\\n\";\nimport { replaceVariables, termToString } from '../util';\nconst components = ['?subject', '?predicate', '?object'];\n/**\n * Handler that deletes an activity in the user's data pod\n * Requires:\n * - the `root.user` handler\n * - the `root[...]` resolver\n * - a queryEngine property in the path settings\n */\n\nexport default class DeleteActivityHandler extends ActivityHandler {\n  // Finds activity triples for deletion\n  async *createResults(activity, document, queryEngine) {\n    const query = replaceVariables(queryTemplate, activity);\n\n    for await (const triple of queryEngine.execute(query, document)) {\n      const terms = components.map(c => termToString(triple.get(c)));\n      yield \"\".concat(terms.join(' '), \".\\n\");\n    }\n  } // Deletes the activity triples from the document\n\n\n  async processResults(results, document, queryEngine) {\n    const sparql = \"DELETE {\\n\".concat(results.join(''), \"}\");\n    await queryEngine.executeUpdate(sparql, document).next();\n    return [];\n  }\n\n}","map":{"version":3,"sources":["/Users/mark/localRepos/StarBrightlyShining/node_modules/@solid/query-ldflex/module/handlers/DeleteActivityHandler.js"],"names":["ActivityHandler","queryTemplate","replaceVariables","termToString","components","DeleteActivityHandler","createResults","activity","document","queryEngine","query","triple","execute","terms","map","c","get","concat","join","processResults","results","sparql","executeUpdate","next"],"mappings":"AAAA,OAAOA,eAAP,MAA4B,mBAA5B;AAEA;;AACA,MAAMC,aAAa,GAAG,qOAAtB;AACA,SAASC,gBAAT,EAA2BC,YAA3B,QAA+C,SAA/C;AACA,MAAMC,UAAU,GAAG,CAAC,UAAD,EAAa,YAAb,EAA2B,SAA3B,CAAnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe,MAAMC,qBAAN,SAAoCL,eAApC,CAAoD;AACjE;AACoB,SAAbM,aAAa,CAACC,QAAD,EAAWC,QAAX,EAAqBC,WAArB,EAAkC;AACpD,UAAMC,KAAK,GAAGR,gBAAgB,CAACD,aAAD,EAAgBM,QAAhB,CAA9B;;AAEA,eAAW,MAAMI,MAAjB,IAA2BF,WAAW,CAACG,OAAZ,CAAoBF,KAApB,EAA2BF,QAA3B,CAA3B,EAAiE;AAC/D,YAAMK,KAAK,GAAGT,UAAU,CAACU,GAAX,CAAeC,CAAC,IAAIZ,YAAY,CAACQ,MAAM,CAACK,GAAP,CAAWD,CAAX,CAAD,CAAhC,CAAd;AACA,YAAM,GAAGE,MAAH,CAAUJ,KAAK,CAACK,IAAN,CAAW,GAAX,CAAV,EAA2B,KAA3B,CAAN;AACD;AACF,GATgE,CAS/D;;;AAGkB,QAAdC,cAAc,CAACC,OAAD,EAAUZ,QAAV,EAAoBC,WAApB,EAAiC;AACnD,UAAMY,MAAM,GAAG,aAAaJ,MAAb,CAAoBG,OAAO,CAACF,IAAR,CAAa,EAAb,CAApB,EAAsC,GAAtC,CAAf;AACA,UAAMT,WAAW,CAACa,aAAZ,CAA0BD,MAA1B,EAAkCb,QAAlC,EAA4Ce,IAA5C,EAAN;AACA,WAAO,EAAP;AACD;;AAhBgE","sourcesContent":["import ActivityHandler from './ActivityHandler';\n\n/* babel-plugin-inline-import './activity-triples.sparql' */\nconst queryTemplate = \"SELECT ?subject ?predicate ?object WHERE {\\n  ?subject a _:type;\\n      <https://www.w3.org/ns/activitystreams#actor> _:actor;\\n      <https://www.w3.org/ns/activitystreams#object> _:object.\\n  ?subject ?predicate ?object.\\n}\\n\";\nimport { replaceVariables, termToString } from '../util';\nconst components = ['?subject', '?predicate', '?object'];\n/**\n * Handler that deletes an activity in the user's data pod\n * Requires:\n * - the `root.user` handler\n * - the `root[...]` resolver\n * - a queryEngine property in the path settings\n */\n\nexport default class DeleteActivityHandler extends ActivityHandler {\n  // Finds activity triples for deletion\n  async *createResults(activity, document, queryEngine) {\n    const query = replaceVariables(queryTemplate, activity);\n\n    for await (const triple of queryEngine.execute(query, document)) {\n      const terms = components.map(c => termToString(triple.get(c)));\n      yield \"\".concat(terms.join(' '), \".\\n\");\n    }\n  } // Deletes the activity triples from the document\n\n\n  async processResults(results, document, queryEngine) {\n    const sparql = \"DELETE {\\n\".concat(results.join(''), \"}\");\n    await queryEngine.executeUpdate(sparql, document).next();\n    return [];\n  }\n\n}"]},"metadata":{},"sourceType":"module"}