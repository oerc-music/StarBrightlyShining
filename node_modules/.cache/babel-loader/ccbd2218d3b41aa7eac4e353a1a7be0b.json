{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ActorSparqlSerializeSparqlTsv = void 0;\n\nconst stream_1 = require(\"stream\");\n\nconst bus_sparql_serialize_1 = require(\"@comunica/bus-sparql-serialize\");\n\nconst rdf_string_ttl_1 = require(\"rdf-string-ttl\");\n/**\n * A comunica SPARQL TSV SPARQL Serialize Actor.\n */\n\n\nclass ActorSparqlSerializeSparqlTsv extends bus_sparql_serialize_1.ActorSparqlSerializeFixedMediaTypes {\n  constructor(args) {\n    super(args);\n  }\n  /**\n   * Converts an RDF term to its TSV representation.\n   * @param {RDF.Term} value An RDF term.\n   * @return {string} A string representation of the given value.\n   */\n\n\n  static bindingToTsvBindings(value) {\n    if (!value) {\n      return '';\n    } // Escape tab, newline and carriage return characters\n\n\n    return rdf_string_ttl_1.termToString(value).replace(/\\t/gu, '\\\\t').replace(/\\n/gu, '\\\\n').replace(/\\r/gu, '\\\\r');\n  }\n\n  async testHandleChecked(action, context) {\n    if (action.type !== 'bindings') {\n      throw new Error('This actor can only handle bindings streams.');\n    }\n\n    return true;\n  }\n\n  async runHandle(action, mediaType, context) {\n    const bindingsAction = action;\n    const data = new stream_1.Readable();\n\n    data._read = () => {// Do nothing\n    }; // Write head\n\n\n    data.push(`${bindingsAction.variables.map(variable => variable.slice(1)).join('\\t')}\\n`); // Write bindings\n\n    bindingsAction.bindingsStream.on('error', error => {\n      data.emit('error', error);\n    });\n    bindingsAction.bindingsStream.on('data', bindings => {\n      data.push(`${bindingsAction.variables.map(key => ActorSparqlSerializeSparqlTsv.bindingToTsvBindings(bindings.get(key))).join('\\t')}\\n`);\n    });\n    bindingsAction.bindingsStream.on('end', () => {\n      data.push(null);\n    });\n    return {\n      data\n    };\n  }\n\n}\n\nexports.ActorSparqlSerializeSparqlTsv = ActorSparqlSerializeSparqlTsv;","map":{"version":3,"sources":["/Users/mark/localRepos/StarBrightlyShining/node_modules/@comunica/actor-sparql-serialize-sparql-tsv/lib/ActorSparqlSerializeSparqlTsv.js"],"names":["Object","defineProperty","exports","value","ActorSparqlSerializeSparqlTsv","stream_1","require","bus_sparql_serialize_1","rdf_string_ttl_1","ActorSparqlSerializeFixedMediaTypes","constructor","args","bindingToTsvBindings","termToString","replace","testHandleChecked","action","context","type","Error","runHandle","mediaType","bindingsAction","data","Readable","_read","push","variables","map","variable","slice","join","bindingsStream","on","error","emit","bindings","key","get"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,6BAAR,GAAwC,KAAK,CAA7C;;AACA,MAAMC,QAAQ,GAAGC,OAAO,CAAC,QAAD,CAAxB;;AACA,MAAMC,sBAAsB,GAAGD,OAAO,CAAC,gCAAD,CAAtC;;AACA,MAAME,gBAAgB,GAAGF,OAAO,CAAC,gBAAD,CAAhC;AACA;AACA;AACA;;;AACA,MAAMF,6BAAN,SAA4CG,sBAAsB,CAACE,mCAAnE,CAAuG;AACnGC,EAAAA,WAAW,CAACC,IAAD,EAAO;AACd,UAAMA,IAAN;AACH;AACD;AACJ;AACA;AACA;AACA;;;AAC+B,SAApBC,oBAAoB,CAACT,KAAD,EAAQ;AAC/B,QAAI,CAACA,KAAL,EAAY;AACR,aAAO,EAAP;AACH,KAH8B,CAI/B;;;AACA,WAAOK,gBAAgB,CAACK,YAAjB,CAA8BV,KAA9B,EACFW,OADE,CACM,MADN,EACc,KADd,EAEFA,OAFE,CAEM,MAFN,EAEc,KAFd,EAGFA,OAHE,CAGM,MAHN,EAGc,KAHd,CAAP;AAIH;;AACsB,QAAjBC,iBAAiB,CAACC,MAAD,EAASC,OAAT,EAAkB;AACrC,QAAID,MAAM,CAACE,IAAP,KAAgB,UAApB,EAAgC;AAC5B,YAAM,IAAIC,KAAJ,CAAU,8CAAV,CAAN;AACH;;AACD,WAAO,IAAP;AACH;;AACc,QAATC,SAAS,CAACJ,MAAD,EAASK,SAAT,EAAoBJ,OAApB,EAA6B;AACxC,UAAMK,cAAc,GAAGN,MAAvB;AACA,UAAMO,IAAI,GAAG,IAAIlB,QAAQ,CAACmB,QAAb,EAAb;;AACAD,IAAAA,IAAI,CAACE,KAAL,GAAa,MAAM,CACf;AACH,KAFD,CAHwC,CAMxC;;;AACAF,IAAAA,IAAI,CAACG,IAAL,CAAW,GAAEJ,cAAc,CAACK,SAAf,CAAyBC,GAAzB,CAA8BC,QAAD,IAAcA,QAAQ,CAACC,KAAT,CAAe,CAAf,CAA3C,EAA8DC,IAA9D,CAAmE,IAAnE,CAAyE,IAAtF,EAPwC,CAQxC;;AACAT,IAAAA,cAAc,CAACU,cAAf,CAA8BC,EAA9B,CAAiC,OAAjC,EAA2CC,KAAD,IAAW;AACjDX,MAAAA,IAAI,CAACY,IAAL,CAAU,OAAV,EAAmBD,KAAnB;AACH,KAFD;AAGAZ,IAAAA,cAAc,CAACU,cAAf,CAA8BC,EAA9B,CAAiC,MAAjC,EAA0CG,QAAD,IAAc;AACnDb,MAAAA,IAAI,CAACG,IAAL,CAAW,GAAEJ,cAAc,CAACK,SAAf,CACRC,GADQ,CACHS,GAAD,IAASjC,6BAA6B,CAC1CQ,oBADa,CACQwB,QAAQ,CAACE,GAAT,CAAaD,GAAb,CADR,CADL,EAGRN,IAHQ,CAGH,IAHG,CAGG,IAHhB;AAIH,KALD;AAMAT,IAAAA,cAAc,CAACU,cAAf,CAA8BC,EAA9B,CAAiC,KAAjC,EAAwC,MAAM;AAC1CV,MAAAA,IAAI,CAACG,IAAL,CAAU,IAAV;AACH,KAFD;AAGA,WAAO;AAAEH,MAAAA;AAAF,KAAP;AACH;;AA/CkG;;AAiDvGrB,OAAO,CAACE,6BAAR,GAAwCA,6BAAxC","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ActorSparqlSerializeSparqlTsv = void 0;\nconst stream_1 = require(\"stream\");\nconst bus_sparql_serialize_1 = require(\"@comunica/bus-sparql-serialize\");\nconst rdf_string_ttl_1 = require(\"rdf-string-ttl\");\n/**\n * A comunica SPARQL TSV SPARQL Serialize Actor.\n */\nclass ActorSparqlSerializeSparqlTsv extends bus_sparql_serialize_1.ActorSparqlSerializeFixedMediaTypes {\n    constructor(args) {\n        super(args);\n    }\n    /**\n     * Converts an RDF term to its TSV representation.\n     * @param {RDF.Term} value An RDF term.\n     * @return {string} A string representation of the given value.\n     */\n    static bindingToTsvBindings(value) {\n        if (!value) {\n            return '';\n        }\n        // Escape tab, newline and carriage return characters\n        return rdf_string_ttl_1.termToString(value)\n            .replace(/\\t/gu, '\\\\t')\n            .replace(/\\n/gu, '\\\\n')\n            .replace(/\\r/gu, '\\\\r');\n    }\n    async testHandleChecked(action, context) {\n        if (action.type !== 'bindings') {\n            throw new Error('This actor can only handle bindings streams.');\n        }\n        return true;\n    }\n    async runHandle(action, mediaType, context) {\n        const bindingsAction = action;\n        const data = new stream_1.Readable();\n        data._read = () => {\n            // Do nothing\n        };\n        // Write head\n        data.push(`${bindingsAction.variables.map((variable) => variable.slice(1)).join('\\t')}\\n`);\n        // Write bindings\n        bindingsAction.bindingsStream.on('error', (error) => {\n            data.emit('error', error);\n        });\n        bindingsAction.bindingsStream.on('data', (bindings) => {\n            data.push(`${bindingsAction.variables\n                .map((key) => ActorSparqlSerializeSparqlTsv\n                .bindingToTsvBindings(bindings.get(key)))\n                .join('\\t')}\\n`);\n        });\n        bindingsAction.bindingsStream.on('end', () => {\n            data.push(null);\n        });\n        return { data };\n    }\n}\nexports.ActorSparqlSerializeSparqlTsv = ActorSparqlSerializeSparqlTsv;\n//# sourceMappingURL=ActorSparqlSerializeSparqlTsv.js.map"]},"metadata":{},"sourceType":"script"}