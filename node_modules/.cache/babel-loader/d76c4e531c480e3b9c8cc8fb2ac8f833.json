{"ast":null,"code":"'use strict';\n\nvar qs = require('querystring'),\n    url = require('url'),\n    xtend = require('xtend');\n\nfunction hasRel(x) {\n  return x && x.rel;\n}\n\nfunction intoRels(acc, x) {\n  function splitRel(rel) {\n    acc[rel] = xtend(x, {\n      rel: rel\n    });\n  }\n\n  x.rel.split(/\\s+/).forEach(splitRel);\n  return acc;\n}\n\nfunction createObjects(acc, p) {\n  // rel=\"next\" => 1: rel 2: next\n  var m = p.match(/\\s*(.+)\\s*=\\s*\"?([^\"]+)\"?/);\n  if (m) acc[m[1]] = m[2];\n  return acc;\n}\n\nfunction parseLink(link) {\n  try {\n    var m = link.match(/<?([^>]*)>(.*)/),\n        linkUrl = m[1],\n        parts = m[2].split(';'),\n        parsedUrl = url.parse(linkUrl),\n        qry = qs.parse(parsedUrl.query);\n    parts.shift();\n    var info = parts.reduce(createObjects, {});\n    info = xtend(qry, info);\n    info.url = linkUrl;\n    return info;\n  } catch (e) {\n    return null;\n  }\n}\n\nmodule.exports = function (linkHeader) {\n  if (!linkHeader) return null;\n  return linkHeader.split(/,\\s*</).map(parseLink).filter(hasRel).reduce(intoRels, {});\n};","map":{"version":3,"sources":["/Users/mark/localRepos/StarBrightlyShining/node_modules/parse-link-header/index.js"],"names":["qs","require","url","xtend","hasRel","x","rel","intoRels","acc","splitRel","split","forEach","createObjects","p","m","match","parseLink","link","linkUrl","parts","parsedUrl","parse","qry","query","shift","info","reduce","e","module","exports","linkHeader","map","filter"],"mappings":"AAAA;;AAEA,IAAIA,EAAE,GAAGC,OAAO,CAAC,aAAD,CAAhB;AAAA,IACIC,GAAG,GAAGD,OAAO,CAAC,KAAD,CADjB;AAAA,IAEIE,KAAK,GAAGF,OAAO,CAAC,OAAD,CAFnB;;AAIA,SAASG,MAAT,CAAgBC,CAAhB,EAAmB;AACjB,SAAOA,CAAC,IAAIA,CAAC,CAACC,GAAd;AACD;;AAED,SAASC,QAAT,CAAmBC,GAAnB,EAAwBH,CAAxB,EAA2B;AACzB,WAASI,QAAT,CAAmBH,GAAnB,EAAwB;AACtBE,IAAAA,GAAG,CAACF,GAAD,CAAH,GAAWH,KAAK,CAACE,CAAD,EAAI;AAAEC,MAAAA,GAAG,EAAEA;AAAP,KAAJ,CAAhB;AACD;;AAEDD,EAAAA,CAAC,CAACC,GAAF,CAAMI,KAAN,CAAY,KAAZ,EAAmBC,OAAnB,CAA2BF,QAA3B;AAEA,SAAOD,GAAP;AACD;;AAED,SAASI,aAAT,CAAwBJ,GAAxB,EAA6BK,CAA7B,EAAgC;AAC9B;AACA,MAAIC,CAAC,GAAGD,CAAC,CAACE,KAAF,CAAQ,2BAAR,CAAR;AACA,MAAID,CAAJ,EAAON,GAAG,CAACM,CAAC,CAAC,CAAD,CAAF,CAAH,GAAYA,CAAC,CAAC,CAAD,CAAb;AACP,SAAON,GAAP;AACD;;AAED,SAASQ,SAAT,CAAmBC,IAAnB,EAAyB;AACvB,MAAI;AACF,QAAIH,CAAC,GAAYG,IAAI,CAACF,KAAL,CAAW,gBAAX,CAAjB;AAAA,QACIG,OAAO,GAAMJ,CAAC,CAAC,CAAD,CADlB;AAAA,QAEIK,KAAK,GAAQL,CAAC,CAAC,CAAD,CAAD,CAAKJ,KAAL,CAAW,GAAX,CAFjB;AAAA,QAGIU,SAAS,GAAIlB,GAAG,CAACmB,KAAJ,CAAUH,OAAV,CAHjB;AAAA,QAIII,GAAG,GAAUtB,EAAE,CAACqB,KAAH,CAASD,SAAS,CAACG,KAAnB,CAJjB;AAMAJ,IAAAA,KAAK,CAACK,KAAN;AAEA,QAAIC,IAAI,GAAGN,KAAK,CACbO,MADQ,CACDd,aADC,EACc,EADd,CAAX;AAGAa,IAAAA,IAAI,GAAGtB,KAAK,CAACmB,GAAD,EAAMG,IAAN,CAAZ;AACAA,IAAAA,IAAI,CAACvB,GAAL,GAAWgB,OAAX;AACA,WAAOO,IAAP;AACD,GAfD,CAeE,OAAOE,CAAP,EAAU;AACV,WAAO,IAAP;AACD;AACF;;AAEDC,MAAM,CAACC,OAAP,GAAiB,UAAUC,UAAV,EAAsB;AACrC,MAAI,CAACA,UAAL,EAAiB,OAAO,IAAP;AAEjB,SAAOA,UAAU,CAACpB,KAAX,CAAiB,OAAjB,EACLqB,GADK,CACDf,SADC,EAELgB,MAFK,CAEE5B,MAFF,EAGLsB,MAHK,CAGEnB,QAHF,EAGY,EAHZ,CAAP;AAID,CAPD","sourcesContent":["'use strict';\n\nvar qs = require('querystring')\n  , url = require('url')\n  , xtend = require('xtend');\n\nfunction hasRel(x) {\n  return x && x.rel;\n}\n\nfunction intoRels (acc, x) {\n  function splitRel (rel) {\n    acc[rel] = xtend(x, { rel: rel });\n  }\n\n  x.rel.split(/\\s+/).forEach(splitRel);\n\n  return acc;\n}\n\nfunction createObjects (acc, p) {\n  // rel=\"next\" => 1: rel 2: next\n  var m = p.match(/\\s*(.+)\\s*=\\s*\"?([^\"]+)\"?/)\n  if (m) acc[m[1]] = m[2];\n  return acc;\n}\n\nfunction parseLink(link) {\n  try {\n    var m         =  link.match(/<?([^>]*)>(.*)/)\n      , linkUrl   =  m[1]\n      , parts     =  m[2].split(';')\n      , parsedUrl =  url.parse(linkUrl)\n      , qry       =  qs.parse(parsedUrl.query);\n\n    parts.shift();\n\n    var info = parts\n      .reduce(createObjects, {});\n    \n    info = xtend(qry, info);\n    info.url = linkUrl;\n    return info;\n  } catch (e) {\n    return null;\n  }\n}\n\nmodule.exports = function (linkHeader) {\n  if (!linkHeader) return null;\n\n  return linkHeader.split(/,\\s*</)\n   .map(parseLink)\n   .filter(hasRel)\n   .reduce(intoRels, {});\n};\n"]},"metadata":{},"sourceType":"script"}