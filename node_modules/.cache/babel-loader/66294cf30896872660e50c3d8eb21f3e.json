{"ast":null,"code":"(function () {\n  var root;\n\n  if (typeof window === 'object' && window) {\n    root = window;\n  } else {\n    root = global;\n  }\n\n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = root.Promise ? root.Promise : Promise;\n  } else if (!root.Promise) {\n    root.Promise = Promise;\n  } // Use polyfill for setImmediate for performance gains\n\n\n  var asap = root.setImmediate || function (fn) {\n    setTimeout(fn, 1);\n  }; // Polyfill for Function.prototype.bind\n\n\n  function bind(fn, thisArg) {\n    return function () {\n      fn.apply(thisArg, arguments);\n    };\n  }\n\n  var isArray = Array.isArray || function (value) {\n    return Object.prototype.toString.call(value) === \"[object Array]\";\n  };\n\n  function Promise(fn) {\n    if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n    if (typeof fn !== 'function') throw new TypeError('not a function');\n    this._state = null;\n    this._value = null;\n    this._deferreds = [];\n    doResolve(fn, bind(resolve, this), bind(reject, this));\n  }\n\n  function handle(deferred) {\n    var me = this;\n\n    if (this._state === null) {\n      this._deferreds.push(deferred);\n\n      return;\n    }\n\n    asap(function () {\n      var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n\n      if (cb === null) {\n        (me._state ? deferred.resolve : deferred.reject)(me._value);\n        return;\n      }\n\n      var ret;\n\n      try {\n        ret = cb(me._value);\n      } catch (e) {\n        deferred.reject(e);\n        return;\n      }\n\n      deferred.resolve(ret);\n    });\n  }\n\n  function resolve(newValue) {\n    try {\n      //Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n      if (newValue === this) throw new TypeError('A promise cannot be resolved with itself.');\n\n      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n        var then = newValue.then;\n\n        if (typeof then === 'function') {\n          doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n          return;\n        }\n      }\n\n      this._state = true;\n      this._value = newValue;\n      finale.call(this);\n    } catch (e) {\n      reject.call(this, e);\n    }\n  }\n\n  function reject(newValue) {\n    this._state = false;\n    this._value = newValue;\n    finale.call(this);\n  }\n\n  function finale() {\n    for (var i = 0, len = this._deferreds.length; i < len; i++) {\n      handle.call(this, this._deferreds[i]);\n    }\n\n    this._deferreds = null;\n  }\n\n  function Handler(onFulfilled, onRejected, resolve, reject) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.resolve = resolve;\n    this.reject = reject;\n  }\n  /**\n   * Take a potentially misbehaving resolver function and make sure\n   * onFulfilled and onRejected are only called once.\n   *\n   * Makes no guarantees about asynchrony.\n   */\n\n\n  function doResolve(fn, onFulfilled, onRejected) {\n    var done = false;\n\n    try {\n      fn(function (value) {\n        if (done) return;\n        done = true;\n        onFulfilled(value);\n      }, function (reason) {\n        if (done) return;\n        done = true;\n        onRejected(reason);\n      });\n    } catch (ex) {\n      if (done) return;\n      done = true;\n      onRejected(ex);\n    }\n  }\n\n  Promise.prototype['catch'] = function (onRejected) {\n    return this.then(null, onRejected);\n  };\n\n  Promise.prototype.then = function (onFulfilled, onRejected) {\n    var me = this;\n    return new Promise(function (resolve, reject) {\n      handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n    });\n  };\n\n  Promise.all = function () {\n    var args = Array.prototype.slice.call(arguments.length === 1 && isArray(arguments[0]) ? arguments[0] : arguments);\n    return new Promise(function (resolve, reject) {\n      if (args.length === 0) return resolve([]);\n      var remaining = args.length;\n\n      function res(i, val) {\n        try {\n          if (val && (typeof val === 'object' || typeof val === 'function')) {\n            var then = val.then;\n\n            if (typeof then === 'function') {\n              then.call(val, function (val) {\n                res(i, val);\n              }, reject);\n              return;\n            }\n          }\n\n          args[i] = val;\n\n          if (--remaining === 0) {\n            resolve(args);\n          }\n        } catch (ex) {\n          reject(ex);\n        }\n      }\n\n      for (var i = 0; i < args.length; i++) {\n        res(i, args[i]);\n      }\n    });\n  };\n\n  Promise.resolve = function (value) {\n    if (value && typeof value === 'object' && value.constructor === Promise) {\n      return value;\n    }\n\n    return new Promise(function (resolve) {\n      resolve(value);\n    });\n  };\n\n  Promise.reject = function (value) {\n    return new Promise(function (resolve, reject) {\n      reject(value);\n    });\n  };\n\n  Promise.race = function (values) {\n    return new Promise(function (resolve, reject) {\n      for (var i = 0, len = values.length; i < len; i++) {\n        values[i].then(resolve, reject);\n      }\n    });\n  };\n})();","map":{"version":3,"sources":["/Users/mark/localRepos/StarBrightlyShining/node_modules/promise-polyfill/Promise.js"],"names":["root","window","global","module","exports","Promise","asap","setImmediate","fn","setTimeout","bind","thisArg","apply","arguments","isArray","Array","value","Object","prototype","toString","call","TypeError","_state","_value","_deferreds","doResolve","resolve","reject","handle","deferred","me","push","cb","onFulfilled","onRejected","ret","e","newValue","then","finale","i","len","length","Handler","done","reason","ex","all","args","slice","remaining","res","val","constructor","race","values"],"mappings":"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","sourcesContent":["(function() {\n    var root;\n\n\tif (typeof window === 'object' && window) {\n\t\troot = window;\n\t} else {\n\t\troot = global;\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = root.Promise ? root.Promise : Promise;\n\t} else if (!root.Promise) {\n\t\troot.Promise = Promise;\n\t}\n\n\t// Use polyfill for setImmediate for performance gains\n\tvar asap = root.setImmediate || function(fn) { setTimeout(fn, 1); };\n\n\t// Polyfill for Function.prototype.bind\n\tfunction bind(fn, thisArg) {\n\t\treturn function() {\n\t\t\tfn.apply(thisArg, arguments);\n\t\t}\n\t}\n\n\tvar isArray = Array.isArray || function(value) { return Object.prototype.toString.call(value) === \"[object Array]\" };\n\n\tfunction Promise(fn) {\n\t\tif (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n\t\tif (typeof fn !== 'function') throw new TypeError('not a function');\n\t\tthis._state = null;\n\t\tthis._value = null;\n\t\tthis._deferreds = []\n\n\t\tdoResolve(fn, bind(resolve, this), bind(reject, this))\n\t}\n\n\tfunction handle(deferred) {\n\t\tvar me = this;\n\t\tif (this._state === null) {\n\t\t\tthis._deferreds.push(deferred);\n\t\t\treturn\n\t\t}\n\t\tasap(function() {\n\t\t\tvar cb = me._state ? deferred.onFulfilled : deferred.onRejected\n\t\t\tif (cb === null) {\n\t\t\t\t(me._state ? deferred.resolve : deferred.reject)(me._value);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar ret;\n\t\t\ttry {\n\t\t\t\tret = cb(me._value);\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\tdeferred.reject(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdeferred.resolve(ret);\n\t\t})\n\t}\n\n\tfunction resolve(newValue) {\n\t\ttry { //Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n\t\t\tif (newValue === this) throw new TypeError('A promise cannot be resolved with itself.');\n\t\t\tif (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n\t\t\t\tvar then = newValue.then;\n\t\t\t\tif (typeof then === 'function') {\n\t\t\t\t\tdoResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._state = true;\n\t\t\tthis._value = newValue;\n\t\t\tfinale.call(this);\n\t\t} catch (e) { reject.call(this, e); }\n\t}\n\n\tfunction reject(newValue) {\n\t\tthis._state = false;\n\t\tthis._value = newValue;\n\t\tfinale.call(this);\n\t}\n\n\tfunction finale() {\n\t\tfor (var i = 0, len = this._deferreds.length; i < len; i++) {\n\t\t\thandle.call(this, this._deferreds[i]);\n\t\t}\n\t\tthis._deferreds = null;\n\t}\n\n\tfunction Handler(onFulfilled, onRejected, resolve, reject){\n\t\tthis.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n\t\tthis.onRejected = typeof onRejected === 'function' ? onRejected : null;\n\t\tthis.resolve = resolve;\n\t\tthis.reject = reject;\n\t}\n\n\t/**\n\t * Take a potentially misbehaving resolver function and make sure\n\t * onFulfilled and onRejected are only called once.\n\t *\n\t * Makes no guarantees about asynchrony.\n\t */\n\tfunction doResolve(fn, onFulfilled, onRejected) {\n\t\tvar done = false;\n\t\ttry {\n\t\t\tfn(function (value) {\n\t\t\t\tif (done) return;\n\t\t\t\tdone = true;\n\t\t\t\tonFulfilled(value);\n\t\t\t}, function (reason) {\n\t\t\t\tif (done) return;\n\t\t\t\tdone = true;\n\t\t\t\tonRejected(reason);\n\t\t\t})\n\t\t} catch (ex) {\n\t\t\tif (done) return;\n\t\t\tdone = true;\n\t\t\tonRejected(ex);\n\t\t}\n\t}\n\n\tPromise.prototype['catch'] = function (onRejected) {\n\t\treturn this.then(null, onRejected);\n\t};\n\n\tPromise.prototype.then = function(onFulfilled, onRejected) {\n\t\tvar me = this;\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\thandle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n\t\t})\n\t};\n\n\tPromise.all = function () {\n\t\tvar args = Array.prototype.slice.call(arguments.length === 1 && isArray(arguments[0]) ? arguments[0] : arguments);\n\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tif (args.length === 0) return resolve([]);\n\t\t\tvar remaining = args.length;\n\t\t\tfunction res(i, val) {\n\t\t\t\ttry {\n\t\t\t\t\tif (val && (typeof val === 'object' || typeof val === 'function')) {\n\t\t\t\t\t\tvar then = val.then;\n\t\t\t\t\t\tif (typeof then === 'function') {\n\t\t\t\t\t\t\tthen.call(val, function (val) { res(i, val) }, reject);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\targs[i] = val;\n\t\t\t\t\tif (--remaining === 0) {\n\t\t\t\t\t\tresolve(args);\n\t\t\t\t\t}\n\t\t\t\t} catch (ex) {\n\t\t\t\t\treject(ex);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var i = 0; i < args.length; i++) {\n\t\t\t\tres(i, args[i]);\n\t\t\t}\n\t\t});\n\t};\n\n\tPromise.resolve = function (value) {\n\t\tif (value && typeof value === 'object' && value.constructor === Promise) {\n\t\t\treturn value;\n\t\t}\n\n\t\treturn new Promise(function (resolve) {\n\t\t\tresolve(value);\n\t\t});\n\t};\n\n\tPromise.reject = function (value) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\treject(value);\n\t\t});\n\t};\n\n\tPromise.race = function (values) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tfor(var i = 0, len = values.length; i < len; i++) {\n\t\t\t\tvalues[i].then(resolve, reject);\n\t\t\t}\n\t\t});\n\t};\n})();"]},"metadata":{},"sourceType":"script"}